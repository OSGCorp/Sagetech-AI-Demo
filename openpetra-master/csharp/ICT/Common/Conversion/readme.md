# C# Conversion Subproject Of OpenPetra

The C# Conversion subproject implements essential date handling and conversion utilities that function across both server and client components of OpenPetra. This cross-cutting concern provides robust date parsing, validation, and formatting capabilities that support the broader administrative and financial functions of the OpenPetra platform. The implementation handles culture-specific date formats, input validation, and automatic error correction to ensure consistent date handling throughout the application.

Key technical capabilities include:

- Culture-aware date parsing from various input formats (numeric, relative, special values)
- Intelligent date validation with automatic correction of common errors
- Bidirectional conversion between DateTime objects and localized string representations
- Comprehensive error handling with user-friendly messages

## Identified Design Elements

1. **Format Flexibility**: Supports multiple date input patterns including numeric formats (211105), relative dates (+/- days), and special values like "today"
2. **Cultural Awareness**: Handles different regional date formats through culture-specific parsing and formatting
3. **Error Correction**: Automatically resolves common user input errors such as month/day transposition
4. **Validation Chain**: Implements a progressive validation approach that attempts multiple parsing strategies before failing

## Architecture
The date conversion utilities are implemented as a cross-cutting concern, making them available throughout the application without creating dependencies between functional modules. This design supports OpenPetra's international focus by properly handling date formats across different regions while maintaining data integrity for financial and administrative operations.

## Business Functions

### Date Conversion
- `Date.cs` : Date conversion utility class for handling various date string formats and transformations in OpenPetra.

## Files
### Date.cs

TDate implements date conversion functionality needed on both server and client sides of OpenPetra. It provides methods to parse date strings in various formats, including numeric patterns (like 211105), relative dates (+/- days), and special values (today). The class handles culture-specific date formats, performs validation, and can automatically correct common errors like month/day transposition. Key methods include LongDateStringToDateTimeInternal which parses strings to DateTime objects with error handling, LongDateStringToDateTime2 which returns verification results, and DateTimeToLongDateString2 for formatting dates as localized strings. The class also contains resource strings for user-friendly error messages.

 **Code Landmarks**
- `Line 89`: Handles relative date calculations with +/- prefix notation for day offsets
- `Line 115`: Implements culture-aware date parsing for numeric formats like 211105 or 21112005
- `Line 190`: Automatically detects and corrects month/day transposition errors when month value exceeds 12

[Generated by the Sage AI expert workbench: 2025-03-30 02:22:57  https://sage-tech.ai/workbench]: #