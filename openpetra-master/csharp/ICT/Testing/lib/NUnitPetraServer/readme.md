# C# NUnit Petra Server Subproject Of OpenPetra

The OpenPetra is a C# application that provides administrative management capabilities for non-profit organizations. The program handles financial transactions and contact management while supporting internationalization requirements. This sub-project implements automated testing infrastructure for the server components along with database connection management for test execution. This provides these capabilities to the OpenPetra program:

- Automated server initialization for integration testing
- Test authentication management
- Database connection establishment and teardown
- Transaction management for test isolation

## Identified Design Elements

1. **Server Connection Management**: The TPetraServerConnector class provides static methods to initialize and terminate server connections during test execution
2. **Credential Management**: Authentication is handled through configuration files with support for both automatic and specified paths
3. **Session State Management**: Test session information is stored in domain objects for consistent access across test cases
4. **Transaction Isolation**: Proper connection setup ensures tests can run independently without interfering with each other

## Overview
The architecture emphasizes test isolation through proper connection management, maintains consistent authentication through configuration-based credentials, and provides a reliable foundation for integration testing. The connector is designed for maintainability and extensibility, with clear separation between server initialization and test execution concerns, enabling developers to focus on writing effective tests rather than managing infrastructure details.

## Business Functions

### Server Connection Management
- `connectServer.cs` : Utility class for connecting to and disconnecting from the OpenPetra server during NUnit testing.

## Files
### connectServer.cs

TPetraServerConnector provides static methods for initializing the OpenPetra server and database connections during NUnit testing. The class implements two key functions: Connect() which initializes the server, authenticates using credentials from configuration files, and establishes a database connection; and Disconnect() which terminates the server session. Connect() handles authentication, transaction management, and client connection setup, storing session information in domain objects. The class requires AutoLogin and AutoLoginPasswd parameters and supports both automatic and specified configuration file paths.

 **Code Landmarks**
- `Line 89`: Uses serializable transaction isolation level specifically for storing session data
- `Line 103`: Commits transaction even on security exception to ensure failed login attempts are recorded in database
- `Line 127`: Stores client ID, client object and site key in DomainManager for global access

[Generated by the Sage AI expert workbench: 2025-03-30 02:22:57  https://sage-tech.ai/workbench]: #