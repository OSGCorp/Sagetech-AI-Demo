# C# Petra Server Admin Console Of OpenPetra

The OpenPetra is a C# application that provides administrative and financial management capabilities for non-profit organizations. The program handles contact management and accounting operations while reducing operational costs. This sub-project implements the server administration interface through a command-line console, providing system administrators with direct control over the OpenPetra server environment. This provides these capabilities to the OpenPetra program:

- Server management through command-line interface
- Client connection monitoring and management
- Database import/export functionality
- Server shutdown and maintenance operations
- Administrative messaging system

## Identified Design Elements

1. Security Token Authentication: The console connects to the server using a security token to ensure proper authorization for administrative operations
2. Interactive and Non-Interactive Modes: Supports both menu-driven interactive usage and command-line parameter-based execution for automation
3. Cross-Platform Compatibility: Designed to run on both Windows and Linux environments with consistent functionality
4. Modular Command Structure: Administrative commands are implemented as discrete operations that can be invoked individually

## Overview
The architecture follows a simple entry point pattern with the main application logic delegated to the TAdminConsole class. The console provides a lightweight interface to critical server management functions without requiring direct database access. It serves as a bridge between system administrators and the OpenPetra server, enabling maintenance tasks and operational monitoring. The design prioritizes simplicity and functionality, focusing on providing essential administrative capabilities through a minimal, efficient interface.

## Business Functions

### Server Administration
- `PetraServerAdminConsole.cs` : Console application that starts the OpenPetra server administration interface.
- `Main.cs` : Command-line administration console for OpenPetra server with functions for server management, client connections, and database operations.

## Files
### Main.cs

Main.cs implements the TAdminConsole class, which provides a command-line interface for administering an OpenPetra server. The file enables server administrators to perform operations like viewing connected clients, disconnecting clients, shutting down the server, importing/exporting databases, and sending administrative messages. Key functionality includes connecting to the server via a security token, displaying server information, executing administrative commands, and providing an interactive menu. Important methods include ShutDown(), Menu(), DisplayPetraServerInformation(), ExportDatabase(), RestoreDatabase(), and DisconnectClient(). The class also supports command-line parameters for non-interactive operation.

 **Code Landmarks**
- `Line 89`: ShutDown method provides both interactive and non-interactive modes for stopping the server
- `Line 174`: Database export/import functionality using yml.gz format with base64 encoding for transfer
- `Line 568`: Security token mechanism creates a temporary file to authorize administrative access
- `Line 701`: Command-line parameter support allows automation of administrative tasks
### PetraServerAdminConsole.cs

PetraServerAdminConsole implements a simple command-line application that serves as the entry point for the OpenPetra server administration interface. The file contains minimal code, with just a Main method that creates an instance of the PetraServerAdminConsole class and calls its run method, which in turn invokes TAdminConsole.Start(). This application can run on both Windows and Linux platforms and acts as a wrapper to start the administrative console functionality that is implemented in external libraries.

 **Code Landmarks**
- `Line 12`: The application is designed to work cross-platform on both Windows and Linux systems.
- `Line 14`: The file serves only as a thin launcher, with the main server logic contained in external libraries (.dll files).

[Generated by the Sage AI expert workbench: 2025-03-30 02:22:57  https://sage-tech.ai/workbench]: #