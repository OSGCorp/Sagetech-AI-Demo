# JavaScript Client Self Service Of Petra

The Petra is a web-based program that helps non-profit organizations manage administration and reduce operational overhead. The program provides contact management and financial tracking while supporting international operations. This sub-project implements a JavaScript-based self-service interface for partners to manage their own information along with responsive UI components that work across devices. This provides these capabilities to the Petra program:

- Partner-managed profile maintenance
- Modal-based editing interface with tabbed organization
- Type-specific form rendering (person, organization, unit, bank)
- Preference and subscription management for partners

## Identified Design Elements

1. **Dual-Format Response Handling**: The architecture supports both HTML rendering for browser display and JSON responses for API consumers
2. **Tab-Based Information Organization**: Partner data is logically segmented into tabs for personal details, addresses, contact information, subscriptions, and financial preferences
3. **Partner Type Specialization**: The system dynamically adjusts form fields and validation based on the partner type (person, family, organization, unit, bank)
4. **Modal Dialog Pattern**: Edit operations occur in modal overlays to maintain context and improve user experience

## Overview
The architecture follows a clean separation between HTML templates and JavaScript functionality. The presentation layer leverages Bootstrap for consistent styling and responsive design. The JavaScript component handles data loading, form population, validation, and server communication, while the HTML template defines the structure and UI elements. This separation makes maintenance straightforward while allowing specialized handling for different partner types and information categories.

## Business Functions

### Partner Self-Service
- `MaintainPartnerSelfService.html` : HTML template for partner self-service maintenance interface with personal, contact, and financial information editing capabilities.
- `MaintainPartnerSelfService.js` : Self-service portal component for partner information management in OpenPetra

## Files
### MaintainPartnerSelfService.html

This HTML template defines the user interface for the MaintainPartnerSelfService form in OpenPetra's self-service module. It provides a comprehensive form for partners to view and update their information, organized into tabs including personal details, addresses, contact information, subscriptions, types, and financial preferences. The template includes sections for different partner types (family, person, organization, unit, bank) with appropriate fields for each. It features modal dialogs for editing, checkbox controls for preferences like mailing options and receipt settings, and integrates with JavaScript utilities for functionality.

 **Code Landmarks**
- `Line 36-130`: Modal dialog template with dynamic content sections that change based on partner class (FAMILY, PERSON, ORGANISATION, UNIT, BANK)
- `Line 131-193`: Tab-based interface organizing partner information into logical sections (addresses, contact details, subscriptions, types, financial, comments)
- `Line 17-33`: Template system using 'phantom' storage for reusable UI components that are cloned and populated dynamically
### MaintainPartnerSelfService.js

MaintainPartnerSelfService.js implements a self-service interface for partners to view and edit their own information in OpenPetra. It provides functionality to load partner details, display them in a modal form, and save changes back to the server. The file handles different partner types (person, organization, unit), manages contact information, partner types/tags, subscriptions, and country selection. Key functions include open_edit(), display_partner(), save_entry(), and helper functions for managing form data and UI interactions like show_tab() and loading specialized data with load_tags(), load_subs(), and load_countries().

 **Code Landmarks**
- `Line 31`: Uses API calls to fetch partner details from server without requiring page reload
- `Line 39`: Creates deep copy of server data to track changes before submission
- `Line 105`: Handles different partner classes (person, organization, unit) with conditional UI display
- `Line 123`: Manages partner type tags and subscriptions through checkbox collections
- `Line 137`: Removes unnecessary data tables before sending updates to server

[Generated by the Sage AI expert workbench: 2025-03-30 02:22:57  https://sage-tech.ai/workbench]: #