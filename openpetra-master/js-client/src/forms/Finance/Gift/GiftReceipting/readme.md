# JavaScript Client Gift Receipting Of Petra

The Petra is a web-based program that provides comprehensive administrative management for non-profit organizations. The program handles financial transactions and donor relationship management. This sub-project implements the client-side functionality for generating and distributing annual gift receipts along with template management capabilities. This provides these capabilities to the Petra program:

- Dynamic generation of annual gift receipts in PDF format
- Customizable receipt templates with logo and signature support
- Multiple distribution methods (download, print, email)
- Template persistence and default management
- Donor selection with autocomplete functionality

## Identified Design Elements

1. Template Management System: Handles loading, storing, and managing HTML templates, logos, and signatures for consistent receipt generation
2. Multi-format Output Support: Provides options to generate receipts as downloadable PDFs, printable documents, or email attachments
3. Server-Client Communication: Implements API calls to the backend for receipt generation and donor data retrieval
4. Default Configuration Persistence: Allows saving and retrieving default templates and settings for streamlined workflow
5. Interactive User Interface: Offers date range selection, donor filtering, and real-time feedback during processing operations

## Overview
The architecture follows a client-side JavaScript approach that interfaces with OpenPetra's backend services. The presentation layer consists of HTML templates and JavaScript controllers that handle user interactions and API communications. The design emphasizes flexibility in receipt customization while maintaining a consistent user experience. The system supports both batch processing for multiple donors and targeted receipt generation for specific donors, with comprehensive error handling and processing feedback through modal dialogs.

## Business Functions

### Gift Receipt Management
- `PrintAnnualReceipts.js` : JavaScript module for generating and managing annual gift receipts in OpenPetra's finance system.
- `PrintAnnualReceipts.html` : HTML form for generating and distributing annual gift receipts with customizable templates and delivery options.

## Files
### PrintAnnualReceipts.html

This HTML file implements a form for generating annual gift receipts in OpenPetra's finance module. It allows users to specify date ranges, select specific donors, and customize the receipt appearance with HTML templates, logos, and signatures. The form provides options to test receipts, download them for archiving, print them directly, or send them via email with customizable subject, body, and sender information. Users can store default templates for future use and clear them when needed. The interface includes autocomplete functionality for donor selection and a waiting modal for processing operations.

 **Code Landmarks**
- `Line 32`: Implements autocomplete functionality for donor selection with key-value mapping
- `Line 48`: Allows storing HTML templates as defaults for future use
- `Line 127`: Provides three different output methods: archive download, direct printing, and email
### PrintAnnualReceipts.js

This file implements functionality for generating annual gift receipts in OpenPetra's finance system. It handles loading, storing, and managing HTML templates, logo images, and signature images for receipts. Key features include generating PDF receipts, emailing receipts, and managing default templates. The file provides functions for reading files, setting templates, storing defaults, and communicating with the server API to generate receipts. Important functions include GenerateAnnualReceipts, LoadDefaultTemplateFiles, SetTemplateDefault, and GenerateAnnualReceiptsRemote.

 **Code Landmarks**
- `Line 31`: Uses FileReader API to handle file uploads for templates and images
- `Line 163`: Implements template management with server-side storage for HTML, logos, and signatures
- `Line 231`: Converts base64-encoded PDF data to a downloadable blob file
- `Line 54`: Chain of asynchronous file reading operations to prepare receipt generation

[Generated by the Sage AI expert workbench: 2025-03-30 02:22:57  https://sage-tech.ai/workbench]: #